/* ?? by dynamis  LastUpdate: 2001/09/09 */


/* [??] ???????????????????S??????????????

          ????????????????????????B */



// ?????????????Win9x?????????????????????B 



/* xbdhtml.js (Cross-Browser Nav4/Gecko/IE DHTML API) 

   14 May 98, Eric Krock, Copyright Netscape Communications

   Permission is granted to reuse, redistribute, and modify 

   without charge.

	

   Updated 18 July 2000 by Vladimir Ermakov, Netscape Communications,

   and Marcell Ortutay, Plugged in Enterprises, to include support of 

   the new Netscape Gecko layout engine.


   Updatated 15 of February 2001 by Vladimir Ermakov, Netscape Communications:

       New Features

        -showElt/hideElt                -convenience functions to use insead of setEltVisibility

        -setEltWidth/setEltHeight       -Set the width/height of a layer

        -getEltPageLeft/getEltPageTop   -XBrowser version of Nav4 pageX/pageY 

        -stringToNumber                 -Returns 0 instead of NaN

       Improved: 

        -getEltWidth/getEltHeight       -Return offsetWidth if width not specified.

        -Also, where possible, replaced detection by browser with detection by property 


   DOM ??????????????????????p??????????????

   ??????Navigator 4.x, IE ?? Gecko ??????????????

   ??????????? JavaScript??????????????? CSSP ???

   ???????????????


   Nav4+/IE4+/Gecko ? JavaScript ??????????????

   - ?????????????????????

   - ????Ž¦??Ž¦????

   - ??? X, Y, Z ????????

   - ??????????

   - ????????? (?Ž¦??) ??????

   - ?????????????????


   document.write() ????? HTML ??????????????????

   ??????? JavaScript ???????????????????


   ?????

   - ???DOM ??????????

     - ??????????????API

   - ?????????????

     - cbdhtml.js ????????????N????

   - ??????????????????????

   - ?????????????????K?

     - ??????????

   - Nav3 ? (ŽÀ????????!) <script language="JavaScript1.2" src="___.js">

     ????????Nav3 ??????????????? 

   - ??????????????  ???????????????

     - ??????????????????????????

       ????????

       1) Is() ????????????????????????? "is" ????

          ?????????????????????????

       2) getEltBackgroundColor ??????????????????

          ??????????????????????K???????

       3) ????????????????? IE4 ???????? temoClipObj 

          ???????(getEltClipXXXX ???6??????????)


   ??????

   - ?? JavaScript ?????????? script ??????????????

     ???????O?????????


     ???????head ????? HTML ????????????


     <!-- ??????????? CSSP ??????????????

          ??????????????????? -->

     <script language="JavaScript1.2" src="xbdhtml.js"> </script>

     <!-- ????????????????????????

         ?????????script ??????????? -->

     <script language="JavaScript1.2"><!--

     //-*** ?????????????????B ***

     //--></script>

*/



// ???"??? JavaScript ????????"??????????? 

// ??Fhttp://developer.nextscape.com/docs/examples/javascript/browser_type.html


function Is ()

{   // ??????????????????????????B 

    var agt=navigator.userAgent.toLowerCase()


    // --- ????????? ---

    this.major = stringToNumber(navigator.appVersion)

    this.minor = parseFloat(navigator.appVersion)


    this.nav  = ((agt.indexOf('mozilla')!=-1) && ((agt.indexOf('spoofer')==-1)

                && (agt.indexOf('compatible') == -1)))

    this.nav2 = (this.nav && (this.major == 2))

    this.nav3 = (this.nav && (this.major == 3))

    this.nav4 = (this.nav && (this.major == 4))

	

	//Netscape 6

	this.nav5 =	(this.nav && (this.major == 5))

	this.nav6 = (this.nav && (this.major == 5))

	this.gecko = (this.nav && (this.major >= 5))


    this.ie   = (agt.indexOf("msie") != -1)

    this.ie3  = (this.ie && (this.major == 2))

    this.ie4  = (this.ie && (this.major == 3))

    this.ie5  = (this.ie && (this.major == 4))



    this.opera = (agt.indexOf("opera") != -1)

     

    this.nav4up = this.nav && (this.major >= 4)

    this.ie4up  = this.ie  && (this.major >= 4)

}



var is = new Is();


// ?????????/?????/OS ??????????????/?????? 

// ????????????B 



// document.write("???");  ?????????????B 

// ?2??(??? minVersion ??????????????????? 

// ?3??(??? maxVersion ????????????????????ŽÀ????? 


function dw(str, minVersion, maxVersion)

{   if ( ((dw.arguments.length < 3) || (is.major <= maxVersion)) 

         && ((dw.arguments.length < 2) || (is.major >= minVersion)))

    document.write(str)  

}



// document write boolean

// if (??document.write("???");  ?????????????B 

// ?2??(??? aBoolean ?????? document.write("???"); ???? 


function dwb (str, aBoolean)

{   if  ((dwb.arguments.length < 2) || aBoolean)

    document.write(str)  

}




// string version

// ????????? str ? "" ?????? 

// ?2??(??? minVersion ??????????????????? 

// ?3??(??? maxVersion ?????????????????? str ?????? 


function sv(str, minVersion, maxVersion)

{   if ( ((sv.arguments.length < 3) || (is.major <= maxVersion)) 

         && ((sv.arguments.length < 2) || (is.major >= minVersion)))

    return str;

    else return "";

}



// string boolean

// (??"???":""  ?????????????B 

// ?2??(??? aBoolean ?????? str ?????? 


function sb (str, aBoolean)

{   if  ((sb.arguments.length < 2) || aBoolean)

    return str;

    else return "";

}





/* The following stub function API for cross-browser HTML 

   element positioning and visibility (CSSP access) was

   derived from Mike Hall's excellent CBDHTML API.


   Thanks also to Danny Goodman (http://www.dannyg.com/)

   and Dan Steinman (http://members.xoom.com/dynduo/).


   ??????F??? CSSP ????????????(getEltLeft, getEltTop ?)

   ???????AIE4 ? CSSP ?????????????o?????????

   ???JavaScript ?????????????A

     ?: var fooElt = getElt("foo");

         setEltLeft(fooElt, 100);

   CSSP ??????????????????????A

     ?: #foo { left: 100px; }

   ??????????????????????(?: document.foo.style.left)?

   ??l???????????left, top, clip ???????IE4 ?????

   ???????????N????IE4 ??????????????????

   ???JavaScript ??????????????????????

   ???CSSP ?????????? JavaScript ?????????????????

   ?????????????

*/



/*     genElt, writeElt, layerClipOrder ?3????????


   ?????????????????????????????????????

   ??????????genElt ? IE4 ? Netspace6 ????? div ??Nav4 ??

   layer/ilayer ???????????????

   writeElt ?????????????o????


   ????3??????????????????????writeElt ? genElt ?

   ????A??????? layerClipOrder ???????B



       genElt ? writeElt ???????


   genElt ? writeElt ????????????????


   ?1?? name ????????????? false ???????????Ž¦??

   false ????????????????B??????????????????

   ?? HTML ????????????????????false ??????????
   ????????????????B


   ?????????????????????????B?????????????

   ?????????????????????????Nav3/IE3 ?????????

   ?????????o????

   writeElt ("foo");

   writeElt ("foo", false, false, false);


   name     ???  ??? id ?

   content  ???  ?????????????

   left     ???  ??????????????

   top      ???  ???????????[??

   z        ???  ??? z-index

   width    ???  ???????????

   height   ???  ????????????

   visibility        ???  "visible", "hidden", "inherit" ?????

   backgroundColor   ???  ??????

   backgroundImage   ???  ???????

   clip              ???  ?????????????E?????R??????

                             ???(???????????!)??????

   relative          ???  ?????????????????????????

                             Nav4 ?? layer/ilayer(?/?) ?????????

   hideEltOnOlderBrowsers  ???  ????? Nav3/IE3 ???? "" ???

   useDivInsteadOfLayer    ???  ??????Nav4 ?? I/LAYER ??? div ??

   classname               ???  ??? class ???

   

   'genElt' ? 'generate element markup' ?????
*/


// CSS ???????A?E???? layer ???????E? ?????? 


function layerClipOrder (cssClipString)

{  var commaPos = cssClipString.lastIndexOf(",");

   return (cssClipString.substring(commaPos+1) + "," + cssClipString.substring(0,commaPos));

}


function genElt (name, content, left, top, z, width, height, visibility, 

                 backgroundColor, backgroundImage, clip, relative, 

                 hideEltOnOlderBrowsers, useDivInsteadOfLayer, classname) 

{ var markup = "";

  if (is.gecko)

  {

    markup = '<DIV ID="' + name + '"' +  

        ((classname)?' CLASS="' + classname + '"':'') + 

        ' STYLE="position:' + ((relative)?'relative;':'absolute;') + 

        ' overflow:none;' + 

        ((left)?' left:' + left + 'px;':'') + 

        ((top)?' top:' + top + 'px;':'') + 

        ((height)?' height:' + height + 'px;':'') + 

        ((width)?' width:' + width + 'px;':'') + 

        ((visibility && (visibility!='')) ? ' visibility:' + visibility + ';' : '') + 

        ((z)?' z-index:' + z + ';':'') + 

        ((backgroundColor)?' background-color:' + backgroundColor + ';':'') + 

        ((backgroundImage)?' background-image:url("' + backgroundImage + '");':'') +  

        ((clip)?' clip:rect("' + clip + '");':'') + 

        '">' + ((content)?content:'') + '</DIV>';

  }


  else if (is.nav && (is.major == 4 || !hideEltOnOlderBrowsers) && 

      !useDivInsteadOfLayer)

  { var tagname = (relative)?'ILAYER':'LAYER';

    if (visibility && (visibility!=''))

    {  if (visibility=="hidden") visibility = "hide";

       else if (visibility=="visible") visibility = "show";

    }

    markup = '<' + tagname + ' ID="' + name + '"' + ((classname)?' CLASS="' + 

        classname + '"':'') + ((left)?' LEFT="' + left + '"':'') + 

        ((top)?' TOP="' + top + '"':'') + ((width)?' WIDTH="' + width + '"':'') + 

        ((height)?' HEIGHT="' + height + '"':'') + 

        ((visibility && (visibility!='')) ? ' VISIBILITY="' + visibility + '"' : '') + 

        ((z)?' Z-INDEX="' + z + '"':'') + 

        ((backgroundColor)?' BGCOLOR="' + backgroundColor + '"':'') + 

        ((backgroundImage)?' BACKGROUND="' + backgroundImage + '"':'') +  

        ((clip)?' CLIP="' + layerClipOrder(clip) + '"':'') + 

        '>' + ((content)?content:'') + '</' + tagname + '>';

  }

 

  else if ((is.ie || (is.nav && useDivInsteadOfLayer)) && (is.major>=4 || !hideEltOnOlderBrowsers))

  { markup = '<DIV ID="' + name + '"' +  

        ((classname)?' CLASS="' + classname + '"':'') + 

        ' STYLE="position:' + ((relative)?'relative;':'absolute;') + 

        ' overflow:none;' + 

        ((left)?' left:' + left + 'px;':'') + 

        ((top)?' top:' + top + 'px;':'') + 

        ((height)?' height:' + height + 'px;':'') + 

        ((width)?' width:' + width + 'px;':'') + 

        ((visibility && (visibility!='')) ? ' visibility:' + visibility + ';' : '') + 

        ((z)?' z-index:' + z + ';':'') + 

        ((backgroundColor)?' background-color:' + backgroundColor + ';':'') + 

        ((backgroundImage)?' background-image:url("' + backgroundImage + '");':'') +  

        ((clip)?' clip:rect("' + clip + '");':'') + 

        '">' + ((content)?content:'') + '</DIV>';

  }


  return markup;

}


function writeElt (name, content, left, top, z, width, height, visibility, 

                   backgroundColor, backgroundImage, clip, relative, 

                   hideEltOnOlderBrowsers, useDivInsteadOfLayer, classname) 

{ if (writeElt.arguments.length < 15) classname = false;

  if (writeElt.arguments.length < 14) useDivInsteadOfLayer = false;

  if (writeElt.arguments.length < 13) hideEltOnOlderBrowsers = false;

  if (writeElt.arguments.length < 12) relative = false;

  if (writeElt.arguments.length < 11) clip = false;

  if (writeElt.arguments.length < 10) backgroundImage = false;

  if (writeElt.arguments.length < 9) backgroundColor = false;

  if (writeElt.arguments.length < 8) visibility = false;

  if (writeElt.arguments.length < 7) height = false;

  if (writeElt.arguments.length < 6) width = false;

  if (writeElt.arguments.length < 5) z = false;

  if (writeElt.arguments.length < 4) top = false;

  if (writeElt.arguments.length < 3) left = false;

  if (writeElt.arguments.length < 2) content = false;

  document.write (genElt (name, content, left, top, z, width, height, visibility, 

                    backgroundColor, backgroundImage, clip, relative, 

                 hideEltOnOlderBrowsers, useDivInsteadOfLayer, classname));

}



/*     ????\?

   ??????????? id ?????? layer ??? name ???????


   getElt (???v??, ?????v??, ?????v?? ...

                 ??????)


   ???????????????

   var fooElement = getElt ("foo")


   ??????????????

   var fooElement = getElt ("bar", "baz", "foo")

    ¥¥?baz ? foo ?????????bar ???????????baz ????

*/


function getElt () 

{ if (is.nav4)

  {

    var currentLayer = document.layers[getElt.arguments[0]];

    for (var i=1; i<getElt.arguments.length && currentLayer; i++)

    {   currentLayer = currentLayer.document.layers[getElt.arguments[i]];

    }

    return currentLayer;

  } 

  else if(document.getElementById && document.getElementsByName)

  { 

    var name = getElt.arguments[getElt.arguments.length-1];

    if(document.getElementById(name))                      //???id ? 

       return document.getElementById(name);

    else if (document.getElementsByName(name))             //?????????? name ? 

	   return document.getElementsByName(name)[0];

  }

  else if (is.ie4up) {

    var elt = eval('document.all.' + getElt.arguments[getElt.arguments.length-1]);

    return(elt);

  }


}


function showElt(elt)

{

	setEltVisibility(elt,'visible');

}


function hideElt(elt)

{

	setEltVisibility(elt);

}


/* value ? "visible", "hidden", "inherit" ???????????????

   ?????? Nav4, Gecko, IE ????? visibility ??????????

*/

function setEltVisibility (elt, value)

{  if (is.nav4) elt.visibility = value;

   else if (elt.style) elt.style.visibility = value;

}



/* ????"visible", "hidden", "inherit" ??????????

   ???? CSS1 ? IE4 ???????????3????????????????

   ???Nav4 ???????? "show" ? "hide" ????????????????

   ???????????? "visible" ? "hidden" ?????????B

*/

function getEltVisibility (elt)

{  if (is.nav4) 

   {  var value = elt.visibility;

      if (value == "show") return "visible";

      else if (value == "hide") return "hidden";

      else return value;

   }

   else if (elt.style) return elt.style.visibility;

}




/* elt ????????????? x,y ?????????????????????

   ????????Ž¦??????????????????????????????

   ??????????

*/

function moveEltTo (elt, x, y) 

{ if (is.nav4) elt.moveTo(x, y);

  else if (is.ie4up) {

    elt.style.pixelLeft = x;

    elt.style.pixelTop  = y;

  }

  else if (is.gecko) {

    elt.style.left = x;

    elt.style.top  = y;

  }

}



/* elt ????????? x,y ???????????? */


function moveEltBy (elt, x, y) 

{ if (is.nav4) elt.moveBy(x, y);

  else if (is.ie4up)  {

    elt.style.pixelLeft += x;

    elt.style.pixelTop  += y;

  }

  else if (is.gecko)  {

    elt.style.left = (stringToNumber(elt.style.left) + x + "px");

    elt.style.top  = (stringToNumber(elt.style.top)  + y + "px");

  }

}


/* Nav4 ? pageX ??????????????? */

function getEltPageLeft(elt) {

  var x;


  if (is.nav4)

    return elt.pageX;

  if (is.ie4up) {

    x = 0;

    while (elt.offsetParent != null) {

      x += elt.offsetLeft;

      elt = elt.offsetParent;

    }

    x += elt.offsetLeft;

    return x;

  }

  if (is.gecko) {

    x = 0;

    while (elt.offsetParent != null) {

      x += elt.offsetLeft;

      elt = elt.offsetParent;

    }

    x += elt.offsetLeft;

    return x;

  }

  return -1;

}


/* Nav4 ? pageY ??????????????? */

function getEltPageTop(elt) {

  var y;


  if (is.nav4)

    return elt.pageY;

  if (is.ie4up) {

    y = 0;

    while (elt.offsetParent != null) {

      y += elt.offsetTop;

      elt = elt.offsetParent;

    }

    y += elt.offsetTop;

    return y;

  }

  if (is.gecko) {

    y = 0;

    while (elt.offsetParent != null) {

      y += elt.offsetTop;

      elt = elt.offsetParent;

    }

    y += elt.offsetTop;

    return y;

  }

  return -1;

}


/* elt ????????????????? */

function setEltLeft (elt, x) {

  if (is.nav4)     elt.left=x;

  else if (is.ie4up) elt.style.pixelLeft=x;

  else if (is.gecko) elt.style.left = (x + "px");

}



/* elt ??????????????? */

function getEltLeft (elt) {

  if (is.nav4)     return (elt.left);

  else if (is.ie4up) return (elt.style.pixelLeft);

  else if (is.gecko) return stringToNumber(elt.style.left);

}


/* elt ??[?????????????? */

function setEltTop (elt, y) 

{ if (is.nav4)     elt.top=y;

  else if (is.ie4up) elt.style.pixelTop=y;

  else if (is.gecko) elt.style.top= (y + "px");

}


/* elt ??[???????????? */

function getEltTop (elt) 

{ if (is.nav4)     return (elt.top);

  else if (is.ie4up) return (elt.style.pixelTop);

  else if (is.gecko) return stringToNumber(elt.style.top);

}


/* elt ???????????? */

function getEltWidth(elt) {


  if (is.nav4) {

    if (elt.document.width)

      return elt.document.width;

    else

      return elt.clip.right - elt.clip.left;

  }

  if (is.ie4up) {

    if (elt.style.pixelWidth)

      return elt.style.pixelWidth;


    else

      return elt.offsetWidth;

  }

  if (is.gecko) {

    if (elt.style.width)

      return stringToNumber(elt.style.width);

    else

      return stringToNumber(elt.offsetWidth);

  }

  return -1;

}


/* elt ?????????????? */

function setEltWidth(elt,wdth)

{

	if(is.nav4)

    { 

	     elt.document.width = wdth;

    }

    else if(elt.style)

    { 

        elt.style.width = wdth;

    }

}


/* elt ????????????? */

function getEltHeight(elt) {

  if (is.nav4) {

    if (elt.document.height)

      return elt.document.height;

    else

      return elt.clip.bottom - elt.clip.top;

  }

  if (is.ie4up) {

    if (elt.style.pixelHeight)

      return elt.style.pixelHeight;

    else

      return elt.clientHeight;

  }

  if (is.gecko) {

    if (elt.style.height)

      return stringToNumber(elt.style.height);

    else

      return stringToNumber(elt.offsetHeight);

  }

  return -1;

}


/* elt ??????????????? */


function setEltHeight(elt,hght)

{

	if(is.nav4)

    { 

		elt.document.height = hght;

    }

    else if(elt.style)

    { 

        elt.style.height = hght;

    }

}


/* elt ?????????????

   ????E??????CSS ??????B

   cliptop, clipright, clipbottom, clipleft ????????????

*/

function setEltClip (elt, cliptop, clipright, clipbottom, clipleft) 

{ if (is.nav4) {

    elt.clip.left   = clipleft;

    elt.clip.top    = cliptop;

    elt.clip.right  = clipright;

    elt.clip.bottom = clipbottom;

  }

  else if (is.ie4up)  elt.style.clip = 'rect(' + cliptop + ' ' +  

       clipright + ' ' + clipbottom + ' ' + clipleft +')';

  else if (is.gecko)  elt.style.clip = 'rect(' + cliptop + ' ' +  

       clipright + ' ' + clipbottom + ' ' + clipleft +')';

}


/* IE ???????

   Nav3 ??????????????????????????????????

*/

function tempClipObj (elt)

{  var clipStr = elt.style.clip;

  

   clipStr = clipStr.substring (clipStr.indexOf("(") + 1);

   this.top = stringToNumber(clipStr);

   clipStr = clipStr.substring (clipStr.indexOf(" ") + 1);

   this.right = stringToNumber(clipStr);

   clipStr = clipStr.substring (clipStr.indexOf(" ") + 1);

   this.bottom = stringToNumber(clipStr);

   clipStr = clipStr.substring (clipStr.indexOf(" ") + 1);

   this.left = stringToNumber(clipStr);

}


/* elt ???????????????????? */

function getEltClipLeft (elt) 

{ if (is.nav4)     return (elt.clip.left);

  else if (elt.style) 

  {  var tempClip = new tempClipObj (elt);

     return tempClip.left;

  }

}


/* elt ?????????[?????????? */

function getEltClipTop (elt) 

{ if (is.nav4)     return (elt.clip.top);

  else if (elt.style) 

  {  var tempClip = new tempClipObj (elt);

     return tempClip.top;

  }

}


/* elt ???????????????????? */

function getEltClipRight (elt) {

  if (is.nav4)     return (elt.clip.right);

  else if (elt.style) 

  {  var tempClip = new tempClipObj (elt);

     return tempClip.right;

  }


}


/* elt ???????????????????? */

function getEltClipBottom (elt) 

{ if (is.nav4)     return (elt.clip.bottom);

  else if (elt.style) 

  {  var tempClip = new tempClipObj (elt);

     return tempClip.bottom;

  }

}


/* elt ??????????????????? */


function getEltClipWidth (elt) 

{

    return (getEltClipRight(elt) - getEltClipLeft(elt));

}



/* elt ???????????????????? */


function getEltClipHeight (elt) 

{

    return (getEltClipBottom(elt) - getEltClipTop(elt));

}



/* ??????????Ž¦?????????????? */


function getCurrentWinWidth() 

{ if (is.nav4)     return(window.innerWidth);

  else if (is.ie4up) return(document.body.clientWidth);

  else if (is.gecko) return(window.innerWidth);

}




/* ??????????Ž¦??????????????? */

function getCurrentWinHeight() 

{ if (is.nav4)     return(window.innerHeight);

  else if (is.ie4up) return(document.body.clientHeight);

  else if (is.gecko) return(window.innerHeight);


}


/* elt ? z-index (????) ????  */


function getEltZIndex (elt) 

{ if (is.nav4) return(elt.zIndex);

  else if (elt.style) return (elt.style.zIndex);

}


/* elt ? z-index ?????? z ?????? */


function setEltZIndex (elt, z) 

{ if (is.nav4) elt.zIndex = z;

  else if (elt.style) elt.style.zIndex = z;

}



/* end CBDHTML derivative functions  */

/* elt ?????????????? imageFilePath ??????


   ??????????? Nav4/Gecko/IE4+ ???????????????????

   ??????????????????ŽÀ??????????????????

   HTML/CSS ??????????????????????????????????

*/

function setEltBackgroundImage (elt, imageFilePath) 

{ if (is.nav4) elt.background.src = imageFilePath;

  else if (is.ie4up) elt.style.backgroundImage = "url(" + imageFilePath + ")";

  else if (is.gecko) elt.style.backgroundImage = "url(" + imageFilePath + ")";

}


/* elt ??????????? URL ??????

   ???????????? Navigator 4.x, Internet Explorer, Gecko ?????

   ??????Navigator 4.x ??

   "file:///F|/DHTML/xbdhtml/xbdhtml/images/redpole.gif"

   ?????????????AInternet Explorer ? Gecko ??

   "url(images/redpole.gif)" ?????????????A"images/redpole.gif"

   ???????????????????

*/


function getEltBackgroundImage (elt) 

{ if (is.nav4) return (elt.background.src);

  else if (elt.style) { 

     var theURL = elt.style.backgroundImage;

     if (typeof(theURL) == "string")

     {  var URLlen = theURL.length;

        return (theURL.substring (4, URLlen-1));

     }

     else return(theURL);

  }

}


/* elt ????? colorNumber ???????

   colorNumber ??? 0xffffff ??????????????"red"??? 16 ? CSS1

   ??F???????

   (Nav4 ???????????? IE ????????????????????)


   ???CSS1 ??6?? ("red"??) ?????????AgetEltBackgroundColor

   ??????????R?????????(????"red" ???? 0xff0000)

   getEltBackgroundColor ? IE4 ? Gecko ??Ž©??????????????Nav4

   ??????Ž©????????????

   ???????????????????????????????????????

   ?????


   ??????????? Nav4/Gecko/IE4+ ???????????????????

   ????????????????ŽÀ?????????????????? HTML/CSS

   ??????????????????????????????????

*/


function setEltBackgroundColor (elt, colorNumber) 

{ if (is.nav4) elt.bgColor = colorNumber;

  else if (elt.style) elt.style.backgroundColor = colorNumber;

}


/* ----------------------------------------------------------

                   ??????????

   ??????????????????????????????

   ---------------------------------------------------------- */


var colorNameString = "aqua,black,blue,fuchsia,gray,green,lime,maroon,navy,olive,purple,red,silver,teal,yellow,white";

var colorNames   = new Array ("aqua", "black", "blue", "fuchsia", "gray",   "green", "lime", "maroon", "navy", "olive",  "purple", "red",    "silver", "teal", "yellow", "white");

var colorNumbers = new Array (0xffff, 0,       0xff,   0xff00ff,  0x808080, 0x8000,  0xff00, 0x800000, 0x80,   0x808000, 0x800080, 0xff0000, 0xc0c0c0, 0x8080, 0xffff00, 0xffffff);




/* aString ???? CSS1 ?????? 16 ??????????????? */

function isColorName (aString)

{ return ( (typeof(aString) == "string") && (colorNameString.indexOf(aString) != -1));

}


/* "white" ????????? 0xffffff ????????????

   IE4 ???????????CSS1 ??6? ???????????

*/

function colorNameToNumber (colorName)

{ for (var i=0; i<16; i++) if (colorNames[i]==colorName) return colorNumbers[i];

  // ???????????????????? 

  // ????? IE4 ?CSS1 ??O??????????????? 

  return colorName;

}


/* 0xffffff ?????? "white" ???????????????

   IE4 ???????????CSS1 ??6? ???????????

*/

function colorNumberToName (colorNumber)

{ for (var i=0; i<16; i++) if (colorNumbers[i]==colorNumber) return colorNames[i];

  return null;

}


/* elt ??????????????

   ("red"????? IE4 ? "#ffffff"???????)

   Nav4 ????????????????IE4 ?????????????

   a) "#" ???? RGB ??Ž¦?6??16???

   b) "red" ??? 16 ????1?

   ???Gecko?????????????

   a) an rgb string like "rgb(255,0,255)"

   b) one of the 16 string color names like red.

   ??????????????????????

   

   ???Netscape6 (Gecko) ???10??????16??????Žß????????

         65280 ??????ŽÀ??? 0x065280 ??????????

         10????????????? ?????????B

   ???CSS1 ??6???? ??????????

*/


function getEltBackgroundColor (elt) 

{

  if (is.nav4) return (elt.bgColor);

  else if (is.ie4up) 

  {

     var colorVal = elt.style.backgroundColor;

     if (isColorName(colorVal)) return colorNameToNumber (colorVal);

     else if (typeof(colorVal) == "string") 

          return (("0x" + colorVal.substring(1)) - 0);

     else return colorVal;

  }

  else if (is.gecko) {

    var colorVal = elt.style.backgroundColor;

    

	 if (typeof(colorVal) == "string")

	 { 	

		if (isColorName(colorVal)) 	

		{

			return colorNameToNumber (colorVal);

		}

		else if (colorVal.indexOf(["rgb"]) != -1) 

		{	

			var sR,sG,sB;

			var iR,iG,iB;

			var i=0;


			ColorString = (elt.style.backgroundColor);

			//ColorString = "rgb(255,20,255)";

			ColorString = ColorString.slice(4,-1);


			while(ColorString[i] != ',' && i < 20){i++;}

			sR = ColorString.slice(0,-(ColorString.length - i));

			i++;

			j = i;

			while(ColorString[j] != ',' && j < 20){j++;}

			sG = ColorString.slice(i,0-(ColorString.length - j));

			j++;

			sB = ColorString.slice(j);

			iR = stringToNumber(sR);

			iG = stringToNumber(sG);

			iB = stringToNumber(sB);

			sR = iR.toString(16);if(sR.length < 2)sR = "0" + sR;if(sR.length < 2)sR = "0" + sR;

			sG = iG.toString(16);if(sG.length < 2)sG = "0" + sG;if(sG.length < 2)sG = "0" + sG;

			sB = iB.toString(16);if(sB.length < 2)sB = "0" + sB;if(sB.length < 2)sB = "0" + sB;


			sRGB = sR.toUpperCase()+sG.toUpperCase()+sB.toUpperCase();

			return (("0x" + sRGB)-0);

		}

	 }

     else return colorVal;

  }

}


/* 100px ????????????????A??????? 0 ???????????

*/

function stringToNumber(s)

{

        return parseInt(('0' + s), 10)

}


/*  ?ŽÒ? dynamis <translator@skillup.jp>

    ??????????????? mozilla.org ????????????????

    http://www.mozilla.org/docs/web-developer/csspapi/xbdhtml.js

    ???????????????????????????????

    ??ŽÒ??????? mozilla.org ??????????????????????

    ???????????????ŽÒ????????

    ???????????A????? URL ??????????B

    http://www.mozilla.gr.jp/jt/index.html */

