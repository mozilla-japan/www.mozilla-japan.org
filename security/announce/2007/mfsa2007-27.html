<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="robots" content="noodp,noydir" />
<link rel="stylesheet" type="text/css" href="/style/kildare/screen.css" media="screen,tv" />
<style>
@font-face { font-family: 'MetaBold'; src: url('//www.mozilla.com/img/fonts/MetaWebPro-Bold.eot'); src: local('_'), url('//www.mozilla.com/img/fonts/MetaWebPro-Bold.woff') format('woff'); font-weight: bold; }
</style>
<link rel="icon" type="image/png" href="/images/mozilla-16.png" />


<title>MFSA 2007-27: エスケープされていない URI が外部プログラムに渡される</title>
<link rel="alternate" hreflang="en" modified="July 30, 2007">
<style type="text/css" media="screen,tv">
  dl.table dt { margin: 0; width: 11em; font-weight: bold; float: left; }
  dl.table dd { margin: 0 0 0 12em; }
  #mainContent ul { padding-left: 0; list-style-type: none; }
</style>

</head>
<body id="www-mozilla-japan-org">
  <ul id="skip">
    <li><a href="#localnav">Skip to Sub Navigation</a></li>
    <li><a href="#main">Skip to Content</a></li>
  </ul>
<div id="header">
  <h1 class="unitPng"><a href="http://www.mozilla.org/" title="Back to home page">mozilla</a></h1>
  <div id="header-contents">
    <ul id="nav">
      <li class=" first"><a href="http://www.mozilla.org/about/">About Us</a></li>
      <li><a href="http://www.mozilla.org/community/">Community Map</a></li>
      <li><a href="http://www.mozilla.org/projects/">Our Projects</a></li>
      <li><a href="http://www.mozilla.org/contribute/">Get Involved</a></li>
    </ul>
  </div>
</div>
<div id="main" class="with-menu">
<div id="main-content">


<h1>Mozilla Foundation セキュリティアドバイザリ 2007-27</h1>
<dl class="table">
  <dt>タイトル</dt><dd>エスケープされていない URI が外部プログラムに渡される</dd>
  <dt>重要度</dt><dd>最高</dd>
  <dt>公開日</dt><dd>2007/07/30</dd>
  <dt>報告者</dt><dd> Jesper Johansson</dd>
  <dt>影響を受ける製品</dt><dd>Firefox</dd><dd>Thunderbird</dd><dd>SeaMonkey</dd>
  <dt>修正済みのバージョン</dt><dd>Firefox 2.0.0.6</dd><dd>Thunderbird 2.0.0.6</dd><dd>Thunderbird 1.5.0.13</dd><dd>SeaMonkey 1.1.4</dd>
</dl>
<h2>概要</h2>
<p>Mozilla 製品が、外部プログラムで処理を行うために渡す URI に含まれる空白やダブルクオートをパーセントエンコードしておらず、受け取った側のプログラムがひとつの URI を複数の引数であるかのように誤って解釈してしまう可能性のあることが、Jesper Johansson 氏によって指摘されました。リスクは、受け手となる特定のプログラムによってサポートされている引数によりますが、少なくとも Firefox/Thunderbird 2.0.0.4 およびそれ以前のバージョンは、任意のコード実行に利用されるおそれがありました (<a href="mfsa2007-23.html">MFSA 2007-23</a> 参照)。大半のプログラムは危険な引数をサポートしていませんが、何らかの予期せぬ動作につながる可能性は考えられます。</p>
<p>外部ハンドラに渡される URI に関する同様の問題が、Billy Rios、Nate McFeters の各氏によって報告されました。IE7 がインストールされた Windows XP 上で Firefox を使用している場合、一部の一般的なプロトコル (<code>mailto:</code> など) の URI に %00 という文字が含まれていると、そのスキーマに対して登録されたプロトコルハンドラが起動せず、代わりに URI の末尾にあるファイル拡張子に基づいたファイル処理プログラムが起動してしまいます。これを Jesper Johansson 氏によって報告された問題と組み合わせると、既知の場所にインストールされたあらゆるプログラムを実行したり、特定の引数が渡るようにすることでシステムの脆弱性を攻撃することも可能となります。また、Secunia による詳しい調査の結果、正しい 2 桁の 16 進数が後に続かない % 文字も、影響を受けるプロトコルについて問題を引き起こすことが分かりました。Firefox/Thunderbird 2.0.0.6 にはこの応用型の元の実証を防ぐ修正が含まれていますが、登録されているプロトコルハンドラの代わりに拡張子を元にしたファイルタイプハンドラが起動してしまう問題は残っています。ただし、単一の予期せぬ URI を引数にして一般的なハンドラを攻撃する方法はまだ見つかっていないようです。この処理は Windows シェル API のプロパティであるため、この応用型は、こうした URI を Windows シェルに渡している、インターネットへの接続機能を持った他のアプリケーションにも影響するものと思われます。</p>
<h2>回避策</h2>
<p>Firefox は、初期設定では外部プロトコルハンドラを起動する前にダイアログを表示します。信頼できないサイト上でそうしたダイアログが表示された場合、特にリクエストされた URL に空白やダブルクオート (&quot;) 文字が含まれていた場合は、必ずキャンセルしてください。ただし Firefox では、メール関連のプロトコルは例外で、初期設定ではダイアログが表示されません。Thunderbird 2.0.0.5 またはそれ以降のバージョンが規定のメールクライアントに設定されている場合は影響を受けませんが、他のクライアントや Thunderbird の古いバージョンが規定のハンドラになっている場合には、メール関連 URI についてもダイアログを表示させることができます (同様に、Thunderbird では <code>http:</code> や <code>ftp:</code> といったブラウザ関連プロトコルについてはダイアログが表示されませんが、規定のブラウザが起動します)。以下の手順で、Firefox でメール関連のリンクをクリックした際、外部プログラムが起動する前にダイアログを表示できます。</p>
<ul>
  <li>ロケーションバーに <kbd>about:config</kbd> と入力します。</li>
  <li>「フィルタ」に <kbd>warn-external</kbd> と入力します。</li>
  <li>mailto、news、nntp、snews という文字が含まれた各行をダブルクリックし、設定値を <samp>true</samp> に変更します。</li>
</ul>
<h2>参考資料</h2>
<p><a href="http://msinfluentials.com/blogs/jesper/archive/2007/07/20/hey-mozilla-quotes-are-not-legal-in-a-url.aspx">Jesper 氏のブログ</a><br>
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=389106">https://bugzilla.mozilla.org/show_bug.cgi?id=389106</a><br>
<a href="http://nvd.nist.gov/nvd.cfm?cvename=CVE-2007-3845">CVE-2007-3845</a></p>
<p>Secunia のアドバイザリ: <a href="http://secunia.com/advisories/26201/">SA26201</a><br>
US-CERT のアドバイザリノート: <a href="http://www.kb.cert.org/vuls/id/783400">VU#783400</a> および <a href="http://www.kb.cert.org/vuls/id/403150">VU##403150</a><br>
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=389580">https://bugzilla.mozilla.org/show_bug.cgi?id=389580</a></p>



</div></div>
<div id="footer-wrap">
  <div id="footer" class="cols">
    <div class="six-col">
      <a id="logo-footer" href="http://www.mozilla.org/"><img src="http://www.mozilla.org/images/template/screen/logo_footer.png" /></a>
      <p id="copyright">Portions of this content are &copy;1998&ndash;2011 by individual mozilla.org contributors. Content available under a Creative Commons <a href="http://www.mozilla.org/foundation/licensing/website-content.html">license</a>.</p>
    </div>
    <div class="col-span">
      これは <a href="http://mozilla.jp/">Mozilla Japan</a> が提供する <a href="http://www.mozilla.org/">mozilla.org</a> の翻訳文書です。<br><a href="http://www.mozilla.org/security/announce/2007/mfsa2007-27.html">英語版</a> 2007/07/30 &mdash; 和訳版 2011/01/06 &mdash; <a href="http://viewvc.svn.mozilla.org/vc/projects/mozilla.org/trunk/security/announce/2007/mfsa2007-27.html">英語版更新履歴</a>
    </div>
    <div class="five-col">
      <h5 class="footer-nav-title"><strong>About Us</strong></h5>
      <ul class="footer-nav"><li><a href="http://www.mozilla.org/about/mission.html">Our Mission</a></li><li><a href="http://www.mozilla.org/about/forums/">Forums</a></li><li><a href="http://www.mozilla.org/about/governance.html">Governance</a></li><li><a href="http://www.mozilla.org/about/organizations.html">Organizations</a></li><li><a href="http://www.mozilla.org/grants/">Grants</a></li><li><a href="http://www.mozilla.org/about/history.html">History</a></li><li><a href="http://www.mozilla.org/about/">More&hellip;</a></li></ul>
    </div>
    <div class="five-col">
      <h5 class="footer-nav-title"><strong>Community Map</strong></h5>
      <ul class="footer-nav"><li><a href="http://www.mozilla.org/community/index.html#applications">Applications</a></li><li><a href="http://www.mozilla.org/community/index.html#code">Code</a></li><li><a href="http://www.mozilla.org/community/index.html#incubators">Incubators</a></li><li><a href="http://www.mozilla.org/community/index.html#community-sites">Community Sites</a></li><li><a href="http://www.mozilla.org/community/directory.html">Directory</a></li><li><a href="http://www.mozilla.org/community/">More&hellip;</a></li></ul>
    </div>
    <div class="five-col">
      <h5 class="footer-nav-title"><strong>Our Projects</strong></h5>
      <ul class="footer-nav"><li><a href="http://www.firefox.com">Firefox</a></li><li><a href="http://www.getthunderbird.com">Thunderbird</a></li><li><a href="http://www.drumbeat.org/projects">Drumbeat</a></li><li><a href="http://www.mozillalabs.com/projects">Mozilla Labs</a></li><li><a href="http://www.mozilla.org/support">Support</a></li><li><a href="https://addons.mozilla.org">Add-ons</a></li><li><a href="http://input.mozilla.com">Feedback</a></li><li><a href="http://www.mozilla.org/security/announce">Security Advisories</a></li><li><a href="http://www.mozilla.org/projects/">More&hellip;</a></li></ul>
    </div>
    <div class="five-col last">
      <h5 class="footer-nav-title"><strong>Get Involved</strong></h5>
      <ul class="footer-nav"><li><a href="https://developer.mozilla.org/En/Developer_Guide">Developing</a></li><li><a href="https://developer.mozilla.org/Project:en/How_to_Help">Documentation</a></li><li><a href="https://donate.mozilla.org/page/contribute/openwebfund">Donate</a></li><li><a href="https://wiki.mozilla.org/L10n">Localization</a></li><li><a href="http://contribute.mozilla.org/Marketing">Marketing</a></li><li><a href="http://quality.mozilla.org/">Testing</a></li>  <li><a href="http://blog.mozilla.com/webdev/get-involved/">Webdev</a></li><li><a href="http://www.mozilla.org/contribute">More&hellip;</a></li></ul>
    </div>
  </div>
</div>
</body>
</html>
